"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[8828],{54933:(e,t,a)=>{a.r(t),a.d(t,{default:()=>be});var l=a(79474),r=a(9037),n=a(83648),s=a(96287),i=a(69604),o=a(61444),c=a(22466),u=a(33783),d=a(32629),g=a(21740),f=a(29769),m=a(21951),p=a(68114),y=a(88140),h=a(2884),k=a(79793),x=a(82890),T=a(3341),C=a(8734),F=a(13504),j=a(44695),b=a(55859);function I(e,t,a){const l={uri:e};return(0,C.qq)(l,t),(0,F.Pz)(l,a?.map((e=>(0,j.HI)(e)??null)).filter(b.P)),l}var S=a(7314),R=a(40088),D=a(67683),A=a(22929),P=a(61115),E=a(85809),L=a(75152),w=a(93535),v=a(906),M=a(64597),N=a(51897),_=a(99964),U=a(78447),B=a(91377),O=a(17997),$=a(13274);const q=l.memo((({tracklistDomRef:e})=>{const{spec:t,logger:a}=(0,A.r)(_.createDesktopSearchBarEventFactory,{}),r=(0,l.useCallback)((()=>{a.logInteraction(t.filterFieldFactory().keyStrokeFilter())}),[a,t]),n=(0,l.useCallback)((()=>{a.logInteraction(t.filterFieldFactory().hitClearFilter())}),[a,t]),s=(0,U.w)().filter((e=>p.gc.includes(e)));return(0,$.jsxs)("div",{className:f.A.searchBoxContainer,children:[(0,$.jsx)(l.Suspense,{fallback:null,children:(0,$.jsx)(B.S,{placeholder:c.Ru.get("playlist.search_in_playlist"),clearOnEscapeInElementRef:e,onFilter:r,onClear:n})}),(0,$.jsx)(O.d,{columns:s})]})}));var z=a(97500),V=a.n(z),K=a(1043),H=a(9869),Q=a(82810),X=a(90970),Z=a(19319),J=a(11249),W=a(71148),G=a(70105),Y=a(66268),ee=a(71969);const te="liked-songs-tags";function ae(){return(0,ee.x)("liked-songs-current-tag-filter",null)}const le="bnAGyFvicDJD8TnVSKnq",re=e=>({id:e.filter,getName:()=>e.name,ubiId:e.name}),ne=(0,l.memo)((({spec:e,nrTracks:t})=>{const{tags:a,currentTag:r,setCurrentTag:n}=function({nrTracks:e}){const t=(0,G.t)(),a=(0,X.jE)(),[r,n]=ae(),[s,i]=(0,l.useState)([]),{data:o}=(0,Z.I)({queryKey:[te],queryFn:()=>t?.getTracksFilterTags(),staleTime:0,gcTime:864e5,placeholderData:J.rX,refetchOnWindowFocus:!1});(0,l.useLayoutEffect)((()=>{const t=o?.find((e=>e.filter===r));if(!t&&r){if(e>0&&o?.length)return;n(null)}i(o??[])}),[r,n,e,o]);const c=(0,l.useCallback)((({data:{list:e}})=>{e===W.Ir.TRACKS&&a.invalidateQueries({queryKey:[te]})}),[a]);(0,Y.l)(W.UV.UPDATE,c);const u=(0,l.useMemo)((()=>s.find((e=>e.filter===r))),[r,s]),d=(0,l.useCallback)((e=>{n(e?.filter??null)}),[n]);return{tags:r||e?s:[],currentTag:u,setCurrentTag:d}}({nrTracks:t}),s=(0,H.s)(),i=(0,l.useCallback)(((t,l,r)=>{let i;if(!t)return i=e.clearButtonFactory().hitClearFilter(),void s.logInteraction(i);const o=a.find((({filter:e})=>e===t));if(!o)return;const c=e.filterChipFactory({identifier:o.name,position:r});l?(i=c.hitClearFilter(),n(null)):(i=c.hitFilter(),o&&n(o)),s.logInteraction(i)}),[s,n,e,a]),o=r?[]:a.map(re),u=r?[re(r)]:[];return a.length?(0,$.jsx)(Q.S,{children:(0,$.jsx)(K.s,{availableFilters:o,selectedFilters:u,toggleFilterId:()=>{},resetFilterIds:()=>n(null),onFilterClick:i,ariaLabel:c.Ru.get("web-player.liked-songs.liked-songs-filter-tags"),clearBtnAriaLabel:c.Ru.get("web-player.liked-songs.clear-filter"),className:V()(le),applyLightThemeControls:!0})}):null}));var se=a(54800),ie=a(42091),oe=a(66853),ce=a(35281),ue=a(60508);const de="bKlB8pmFVoswJlZ_jhtL",ge=l.memo((function({metadata:e,onClickTogglePlay:t,isPlaying:a,spec:r,logger:n,backgroundColor:s,canSort:i,canFilter:o}){const{uri:u,name:d,totalLength:g}=e,f=(0,l.useRef)(null),m=(0,l.useMemo)((()=>r.actionBarFactory()),[r]),p=(0,l.useMemo)((()=>m.shuffleButtonContainerFactory()),[m]),y=(0,l.useMemo)((()=>m.filtersFactory()),[m]),h=g>0,k=g>0,x=i&&o,T=(0,ue.X)(),C=(0,l.useCallback)(((e,t)=>{const a=m.downloadButtonFactory();t===M.NV.ADD?n.logInteraction(a.hitDownload({itemToDownload:u})):t===M.NV.REMOVE?n.logInteraction(a.hitRemoveDownload({itemToRemoveFromDownloads:u})):t===M.NV.NO_PERMISSION&&n.logInteraction(a.hitUiReveal())}),[m,n,u]),F=(0,ie.j)(),j=(0,P.NC)(oe.cLA);return(0,$.jsxs)(se.E,{backgroundColor:s,children:[(0,$.jsxs)(Q.S,{children:[k?(0,$.jsx)(w.D,{onClick:t,isPlaying:a,size:F,uri:u,ariaPauseLabel:c.Ru.get("playlist.a11y.pause",d),ariaPlayLabel:c.Ru.get("playlist.a11y.play",d)}):null,T&&(0,$.jsx)(D.r,{spec:p,children:(0,$.jsx)(ce.Y,{entityName:d,contextUri:u,activationPlacement:"bottomEnd",size:F})}),(0,$.jsx)(E.f,{uri:u,canDownload:h,isFollowing:!0,onFollow:()=>{},size:F,onClick:C}),x?(0,$.jsx)(D.r,{spec:m,children:(0,$.jsx)(q,{tracklistDomRef:f})}):(0,$.jsx)("div",{className:de,children:(0,$.jsx)(L.u,{property:N.mA,renderNewExperience:()=>(0,$.jsx)(v.g,{options:[],onSelect:()=>{},selected:null,enableViewModeMenu:!0})})})]}),j&&(0,$.jsx)(ne,{spec:y,nrTracks:g})]})}));var fe=a(35956),me=a(85866),pe=a(44662),ye=a(80156),he=a(49865),ke=a(86892),xe=a(64648),Te=a(16832);const Ce=[h.$.INDEX,h.$.TITLE_AND_ARTIST,h.$.ALBUM,h.$.ADDED_AT,h.$.DURATION],Fe=({data:e,canFilter:t,canSort:a})=>{const{uri:r,name:o,totalLength:C}=e.metadata,F=(0,l.useRef)(null),j=(0,T.z6)("#5038a0"),[S]=ae(),{filter:P}=(0,l.useContext)(m.g),{sortState:E,setSortState:L}=(0,l.useContext)(p.cL),{spec:w,logger:v}=(0,A.r)(i.k,{data:{uri:r}}),M=l.useMemo((()=>w.headerFactory()),[w]),N=l.useMemo((()=>w.tracklistFactory()),[w]);(0,l.useEffect)((()=>{null===E.column&&L({column:h.$.ADDED_AT,order:h.H.DESC})}),[E,L]);const _=(0,n.wQ)(),U=(0,n.zy)(),B="POP"!==_?new URLSearchParams(U.search).get("uri"):null,{isPlaying:O,togglePlay:q,usePlayContextItem:z,isActive:V}=(0,R.P)(I(r,(0,fe.c)(E),[P,S].filter(b.P)),{featureIdentifier:"your_library",referrerIdentifier:"your_library"}),K=()=>{const e=(0,ye.$I)({isPlaying:O,isActive:V,spec:w.actionBarFactory().playButtonFactory(),logger:v,uri:r});q({loggingParams:e})},[H]=(0,pe.z1)(),{isCompactMode:Q}=(0,x.an)(),X=(({isCompactMode:e=!1})=>{const t=[...Ce];return e&&t.splice(t.indexOf(h.$.TITLE_AND_ARTIST),1,h.$.TITLE,h.$.ARTIST),t})({isCompactMode:Q});return(0,$.jsx)(y.a,{columns:X,children:(0,$.jsxs)("section",{role:"presentation",className:f.A.playlist,"data-testid":"playlist-page",children:[(0,$.jsx)(u.Q,{children:c.Ru.get("playlist.page-title",o)}),(0,$.jsx)(k.x,{metadata:{...e.metadata,hasSpotifyTracks:!0},totalItems:H,isPlaying:O,togglePlay:K,backgroundColor:j,specLikedSongs:M}),(0,$.jsx)(ge,{metadata:e.metadata,onClickTogglePlay:K,isPlaying:O,spec:w,logger:v,backgroundColor:j,canSort:a,canFilter:t}),(0,$.jsx)("div",{className:"contentSpacing",children:C>0?(0,$.jsx)(l.Suspense,{fallback:(0,$.jsx)(g.A,{hasError:!1,errorMessage:c.Ru.get("error.request-collection-tracks-failure")}),children:(0,$.jsx)(D.r,{spec:N,children:(0,$.jsx)(me.b,{nrTracks:C,collectionUri:r,scrollToUri:B,usePlayContextItem:z,outerDomRef:F,spec:N,initialItems:e.contents.items,isCompactMode:Q,tagFilter:S})})}):(0,$.jsx)(d.p,{message:c.Ru.get("collection.empty-page.songs-subtitle"),title:c.Ru.get("collection.empty-page.songs-title"),linkTo:"/search",linkTitle:c.Ru.get("collection.empty-page.songs-cta"),renderInline:!0,children:(0,$.jsx)(s.v,{"aria-hidden":"true"})})})]})})},je=l.memo((function({user:e,uri:t}){const{filter:a}=(0,l.useContext)(m.g),{sortState:r}=(0,l.useContext)(p.cL),[n]=ae(),s=function(e,t,a){const r=(0,l.useContext)(S.Z),n=(0,X.jE)(),s=(0,ke.U0)((()=>["useLikedSongs",e,a]),[e,a]),{data:i}=(0,Z.I)({queryKey:s(),queryFn:()=>r.getTracks(a),gcTime:18e5,placeholderData:J.rX,refetchOnWindowFocus:!1}),o=(0,l.useCallback)((()=>{n.invalidateQueries({queryKey:s()})}),[n,s]);(0,Y.l)(W.UV.UPDATE,o);const c=(0,Te.$R)(t.id);return c&&i?{metadata:{uri:e,name:c.name,images:c.images,totalLength:i?.totalLength,unfilteredTotalLength:i.unfilteredTotalLength,owner:(0,xe.w)(t)},contents:i}:null}(t,e,{offset:0,limit:25,sort:(0,fe.c)(r),filters:[a,n].filter(b.P)}),i=(0,l.useContext)(S.Z).getCapabilities();return s?(0,$.jsx)(Fe,{data:s,canFilter:i.canFilterTracksAndEpisodes&&s.metadata.unfilteredTotalLength>0,canSort:i.canSortTracksAndEpisodes&&s.metadata.unfilteredTotalLength>0}):(0,$.jsx)(g.A,{hasError:!1,errorMessage:c.Ru.get("error.not_found.title.playlist"),loadOffline:i.canModifyOffline})})),be=()=>{const{user:e}=(0,r.d4)(he.Ht);if(null===e)return null;const t=(0,o.fH)(e.id).toURI();return(0,$.jsx)(p.sn,{uri:t,children:(0,$.jsx)(m.s,{uri:t,children:(0,$.jsx)(pe.S1,{children:(0,$.jsx)(je,{uri:t,user:e})})})})}},3341:(e,t,a)=>{a.d(t,{Hk:()=>r.H,z6:()=>l.z});a(98251);var l=a(63479),r=a(42341)}}]);
//# sourceMappingURL=xpui-routes-collection-songs.js.map