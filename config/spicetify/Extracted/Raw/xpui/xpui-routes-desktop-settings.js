"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[2391,6457],{71525:(e,t,s)=>{s.r(t),s.d(t,{DesktopSettings:()=>js,default:()=>ms});var n=s(79474),i=s(61115),r=s(60191),a=s(61144),l=s(22466),o=s(83692),c=s(85616),d=s(92969),u=s(81592),g=s(28731),h=s(97500),p=s.n(h),x=s(14859),j=s(92467),m=s(21951);const y={section:"x-settings-section",hidden:"x-settings-hidden"};var f=s(13274);function k({children:e,filterMatchQuery:t}){const{filter:s}=(0,n.useContext)(m.g),{setSectionMatch:i,sectionContainsMatch:r}=(0,x.A)(),a=(0,j.C)(s,t);(0,n.useEffect)((()=>{i(a)}),[a,i]);const l=!a&&!r;return(0,f.jsx)("div",{className:p()(y.section,{[y.hidden]:l}),children:e})}function v(e){return(0,f.jsx)(x.R,{children:(0,f.jsx)(k,{...e})})}var R=s(98891),b=s(11854);function w({children:e,className:t,semanticColor:s="textBase"}){const{filter:i}=(0,n.useContext)(m.g);return(0,f.jsx)(R.E,{as:"h2",variant:"bodyMediumBold",semanticColor:s,className:t,children:(0,f.jsx)(b.M,{searchWords:[i],textToHighlight:e})})}const S=({settings:{values:e},setValue:t})=>navigator&&/^win/i.test(navigator.platform)?(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("desktop.settings.compatibility"),children:[(0,f.jsx)(w,{children:l.Ru.get("desktop.settings.compatibility")}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.enableHardwareAcceleration"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.enableHardwareAcceleration",children:l.Ru.get("desktop.settings.enableHardwareAcceleration")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.enableHardwareAcceleration",value:!!e["ui.hardware_acceleration"],onSelected:e=>{t("ui.hardware_acceleration",e)}})})]})]}):null;var C=s(49322),M=s(66853),F=s(1640),Q=s(51897),N=s(53839);function q(){const e=(0,F.G)(),[t,s]=(0,n.useState)(!1),i=(0,n.useCallback)((t=>{e.setEnabledState(t)}),[e]);return(0,n.useEffect)((()=>e.subscribeToEnabledState(s)),[e]),[t,i]}function A(){const e=(0,F.G)(),[t,s]=(0,n.useState)(e.getPreset()),i=(0,n.useCallback)((t=>{e.setPreset(t)}),[e]);return(0,n.useEffect)((()=>e.subscribeToPresetChange((e=>{s(e)})))),[t,i]}var E=s(98678);function _(e){return`${e>0?`+${e}`:e}dB`}const W={wrapper:"x-settings-equalizerPanelWrapper",preset:"x-settings-equalizerPanelPreset",filters:"x-settings-equalizerPanelFilters",filter:"x-settings-equalizerPanelFilter",input:"x-settings-equalizerPanelInput",label:"x-settings-equalizerPanelLabel",gainLabel:"x-settings-equalizerPanelGainLabel",gainLabelUp:"x-settings-equalizerPanelGainLabelUp",gainLabelDown:"x-settings-equalizerPanelGainLabelDown",canvas:"x-settings-equalizerPanelCanvas"};function L({filter:e,onChange:t}){const s=(0,F.G)(),i=(0,n.useRef)(null),[r]=A();(0,n.useEffect)((()=>{const t=r.filters.find((t=>t.key===e.key));i.current&&t&&(i.current.value=`${t.gain}`)}),[r,e.key]),(0,n.useEffect)((()=>{i.current&&i.current.setAttribute("aria-valuetext",l.Ru.get("equalizer.filterA11yValueText",e.gain))}),[]);const a=(0,E.YQ)(((e,t)=>{s.setFilterGain(e,t)}),100,{maxWait:200});return(0,f.jsxs)("div",{className:W.filter,children:[(0,f.jsx)("input",{"aria-label":l.Ru.get("equalizer.filterLabel",e.frequency),ref:i,type:"range",min:-N.Zs,max:N.Zs,step:.1,defaultValue:e.gain,className:W.input,onChange:s=>{const n=parseFloat(s.target.value);s.target.setAttribute("aria-valuetext",l.Ru.get("equalizer.filterA11yValueText",n)),a(e.key,n),t(n)}}),(0,f.jsx)("label",{className:W.label,children:(o=e.frequency,o>=1e3?o/1e3+"KHz":`${o}Hz`)})]});var o}const V=()=>{const[e,t]=(0,n.useState)(window.devicePixelRatio||1);return(0,n.useEffect)((()=>{const e=()=>{matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`).addEventListener("change",(()=>{t(window.devicePixelRatio),e()}),{once:!0})};e()}),[]),e};var I=s(81465);function T(e,t){e.moveTo(t[0],t[1]);for(let s=2;s<t.length-1;s+=2)e.lineTo(t[s],t[s+1])}function O(e){const t=.6,s=[],n=e.reduce(((e,t)=>(e.push(t.x),e.push(t.y),e)),[]);n.unshift(e[0].y),n.unshift(e[0].x),n.push(e[e.length-1].x),n.push(e[e.length-1].y);for(let e=2;e<n.length-4;e+=2)for(let i=0;i<=16;i++){const r=(n[e+2]-n[e-2])*t,a=(n[e+4]-n[e])*t,l=(n[e+3]-n[e-1])*t,o=(n[e+5]-n[e+1])*t,c=i/16,d=2*Math.pow(c,3)-3*Math.pow(c,2)+1,u=-2*Math.pow(c,3)+3*Math.pow(c,2),g=Math.pow(c,3)-2*Math.pow(c,2)+c,h=Math.pow(c,3)-Math.pow(c,2),p=d*n[e]+u*n[e+2]+g*r+h*a,x=d*n[e+1]+u*n[e+3]+g*l+h*o;s.push(p),s.push(x)}return s}var z=s(49555);function D(e,t){const s=e.getContext("2d");s&&(s.clearRect(0,0,e.clientWidth,e.clientHeight),function(e,t,s){const n=t.clientWidth,i=t.clientHeight,r=n/s.length/2;e.beginPath();const a=e.createLinearGradient(n/2,0,n/2,i);a.addColorStop(0,"rgba(11%, 73%, 33%, 100%)"),a.addColorStop(1,"rgba(11%, 73%, 33%, 0%)"),e.fillStyle=a,T(e,O(s)),e.lineTo(n-r,i),e.lineTo(r,i),e.fill()}(s,e,t),function(e,t){e.beginPath(),e.strokeStyle="rgb(11%, 73%, 33%)",e.lineWidth=4,T(e,O(t)),e.stroke()}(s,t),function(e,t){e.fillStyle=z.white,t.forEach((t=>{e.beginPath(),e.arc(t.x,t.y,4,0,2*Math.PI),e.fill()}))}(s,t))}const H=60,K=300;function U(e,t){const s=t.clientWidth/e.length;return e.map(((e,n)=>({x:n*s+s/2,y:t.clientHeight-(e+N.Zs+3)/(2*N.Zs+6)*t.clientHeight})))}function P(e){const t=(0,n.useRef)(null),s=V(),i=(0,n.useCallback)((()=>{if(!t.current)return;const e=s,n=t.current.getBoundingClientRect();t.current.width=n.width*e,t.current.height=n.height*e,t.current.getContext("2d")?.scale(e,e)}),[s]),r=(0,n.useCallback)((()=>{if(!t.current||!e.current)return;const s=U(e.current,t.current);D(t.current,s)}),[e]),a=(0,n.useCallback)((s=>{if(!t.current||!e.current)return;const n=U(e.current,t.current),i=U(s,t.current);!function(e,t,s){const n=H*(K/1e3);let i=0;const r=JSON.parse(JSON.stringify(t)),a=s.map(((e,s)=>e.y-t[s].y)),l=()=>{if(!(i>=n)){for(let e=0;e<r.length;e++){const l=t[e].y,d=a[e];r[e].y=(s=l,o=d,c=i,(c/=n/2)<1?o/2*Math.pow(c,3)+s:(c-=2,o/2*(Math.pow(c,3)+2)+s))}var s,o,c;D(e,r),i++,window.requestAnimationFrame(l)}};window.requestAnimationFrame(l)}(t.current,n,i)}),[e]);return(0,n.useEffect)((()=>{i(),r()}),[i,r]),(0,I.w)({refOrElement:t,onResize:()=>{i(),r()}}),{canvasRef:t,drawCanvas:r,animateCanvas:a}}function B(){const[e,t]=q(),[s,i]=A(),r=(0,n.useRef)(s.filters.map((e=>e.gain))),{canvasRef:a,drawCanvas:o,animateCanvas:c}=P(r);return(0,n.useEffect)((()=>{const e=s.filters.map((e=>e.gain));"custom"!==s.key&&c(e),r.current=e}),[s,c]),(0,f.jsxs)("div",{className:W.wrapper,children:[(0,f.jsx)("canvas",{"aria-label":l.Ru.get("equalizer.equalizer"),role:"img",className:W.canvas,ref:a}),(0,f.jsx)("label",{className:p()(W.gainLabel,W.gainLabelUp),children:_(N.Zs)}),(0,f.jsx)("label",{className:p()(W.gainLabel,W.gainLabelDown),children:_(-N.Zs)}),(0,f.jsx)("div",{className:W.filters,dir:"ltr",children:s.filters.map(((s,n)=>(0,f.jsx)(L,{filter:s,onChange:s=>{r.current[n]=s,o(),e||t(!0),i((0,N.zP)(r.current))}},s.key)))})]})}var G=s(57770);const Z={container:"x-settings-equalizerPresetsContainer",label:"x-settings-equalizerPresetsLabel"};function J(){const[e,t]=q(),[s,n]=A();return(0,f.jsxs)("div",{className:Z.container,children:[(0,f.jsx)(R.E,{as:"label",variant:"bodySmall",semanticColor:"textSubdued",htmlFor:"desktop.equalizer.preset",className:Z.label,children:l.Ru.get("equalizer.presets")}),(0,f.jsxs)(G.C,{id:"desktop.equalizer.preset",value:s.key,onSelect:s=>{n(s),e||t(!0)},children:["custom"===s.key&&(0,f.jsx)("option",{value:s.key,children:s.displayName}),Object.entries(N.fG).map((([e,t])=>(0,f.jsx)("option",{value:e,children:t.displayName},e)))]})]})}var Y=s(26683);function $(){const[e,t]=q(),[,s]=A();return(0,f.jsx)(Y.n,{onClick:()=>{s(N.fG.flat.key),e||t(!0)},size:"small",children:l.Ru.get("equalizer.reset")})}function X(){const[e,t]=q();return(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("equalizer.equalizer"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"settings.equalizer",children:l.Ru.get("equalizer.equalizer")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"settings.equalizer",value:e,onSelected:t})})]})}const ee="x-settings-equalizerSection",te="x-settings-equalizerWrapper",se="x-settings-equalizerResetButtonWrapper";function ne(){const e=(0,F.G)();return(0,i.NC)(Q.AM,{loadingValue:!1})&&e.isSupported()?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(X,{}),(0,f.jsx)(d.i,{filterMatchQuery:l.Ru.get("equalizer.equalizer"),children:(0,f.jsxs)("div",{className:ee,children:[(0,f.jsx)(J,{}),(0,f.jsx)("div",{className:te,children:(0,f.jsx)(B,{})}),(0,f.jsx)("div",{className:se,children:(0,f.jsx)($,{})})]})})]}):null}const ie="x-settings-crossFadeContainer",re=12e3,ae=({settings:{values:e},setValue:t})=>{const s=(0,i.NC)(M.$GE),r=(0,i.NC)(M.UrL),a=(0,i.NC)(M.tsC),[h,p]=(0,n.useState)(-1),x=-1===h?Number(e["audio.crossfade.time_v2"]):h,j=`${Math.round(x/1e3)} ${l.Ru.get("desktop.settings.sec")}`;return(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("desktop.settings.playback"),children:[(0,f.jsx)(w,{children:l.Ru.get("desktop.settings.playback")}),void 0!==e["audio.crossfade_v2"]&&(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.crossfadeTracks"),children:[(0,f.jsxs)(g.q,{children:[(0,f.jsx)(c.W,{htmlFor:"desktop.settings.crossfadeTracks",children:l.Ru.get("desktop.settings.crossfadeTracks")}),e["audio.crossfade_v2"]&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:ie,children:(0,f.jsx)(C.z2,{value:x,max:re,step:1e3,labelText:l.Ru.get("desktop.settings.crossfadeTracks"),onStepBackward:()=>{p(Math.max(0,x-1e3))},onStepForward:()=>{p(Math.min(re,x+1e3))},onDragStart:e=>{p(e*re)},onDragMove:e=>{p(e*re)},onDragEnd:e=>{const s=Math.floor(e*re);p(s),t("audio.crossfade.time_v2",s)}})}),(0,f.jsx)(R.E,{variant:"bodySmall",semanticColor:"textSubdued",children:j})]})]}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.crossfadeTracks",value:!!e["audio.crossfade_v2"],onSelected:e=>{t("audio.crossfade_v2",e)}})})]}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.automixInfo"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.automixInfo",children:l.Ru.get("desktop.settings.automixInfo")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.automixInfo",value:!!e["audio.automix"],onSelected:e=>{t("audio.automix",e)}})})]}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.monoDownmixer"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.monoDownmixer",children:l.Ru.get("desktop.settings.monoDownmixer")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.monoDownmixer",value:!!e["audio.downmixer_v2"],onSelected:e=>{t("audio.downmixer_v2",e)}})})]}),s&&(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.silenceTrimmer"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.silenceTrimmer",children:l.Ru.get("desktop.settings.silenceTrimmer")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.silenceTrimmer",value:!!e["audio.silence_trimmer_v2"],onSelected:e=>{t("audio.silence_trimmer_v2",e)}})})]}),r&&(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.dynamicNormalizer"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.dynamicNormalizer",children:l.Ru.get("desktop.settings.dynamicNormalizer")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.dynamicNormalizer",value:!!e["audio.dynamic_normalizer_v2"],onSelected:e=>{t("audio.dynamic_normalizer_v2",e)}})})]}),a&&(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.otfn"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.otfn",children:l.Ru.get("desktop.settings.otfn")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.otfn",value:!!e["audio.otfn_v2"],onSelected:e=>{t("audio.otfn_v2",e)}})})]}),(0,f.jsx)(ne,{})]})};var le=s(93319);const oe={get[le.WZ.MINIMIZED](){return l.Ru.get("desktop.settings.autostartMinimized")},get[le.WZ.NORMAL](){return l.Ru.get("desktop.settings.autostartNormal")},get[le.WZ.OFF](){return l.Ru.get("desktop.settings.autostartOff")}},ce=({settings:{values:e},setValue:t})=>(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("desktop.settings.startupAndWindowBehavior"),children:[(0,f.jsx)(w,{children:l.Ru.get("desktop.settings.startupAndWindowBehavior")}),void 0!==e["app.autostart-mode"]&&(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.autostart"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.autostart",children:l.Ru.get("desktop.settings.autostart")})}),(0,f.jsx)(u.n,{children:(0,f.jsxs)(G.C,{id:"desktop.settings.autostart",value:e["app.autostart-mode"],onSelect:e=>{t("app.autostart-mode",e)},children:[(0,f.jsx)("option",{value:le.WZ.MINIMIZED,children:oe[le.WZ.MINIMIZED]}),(0,f.jsx)("option",{value:le.WZ.NORMAL,children:oe[le.WZ.NORMAL]}),(0,f.jsx)("option",{value:le.WZ.OFF,children:oe[le.WZ.OFF]})]})})]}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.closeShouldMinimize"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.closeShouldMinimize",children:l.Ru.get("desktop.settings.closeShouldMinimize")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.closeShouldMinimize",value:!!e["ui.minimize_to_tray"],onSelected:e=>{t("ui.minimize_to_tray",e)}})})]})]}),de={"auto-detect":{label:()=>l.Ru.get("desktop.settings.proxy.autodetect")},"no-proxy":{label:()=>l.Ru.get("desktop.settings.proxy.noproxy")},http:{label:()=>l.Ru.get("desktop.settings.proxy.http")},socks4:{label:()=>l.Ru.get("desktop.settings.proxy.socks4")},socks5:{label:()=>l.Ru.get("desktop.settings.proxy.socks5")}},ue=[{enumKey:"auto-detect",enumValue:0},{enumKey:"no-proxy",enumValue:1},{enumKey:"http",enumValue:2},{enumKey:"socks4",enumValue:3},{enumKey:"socks5",enumValue:4}];var ge=s(86838);const he="mpdBa62OP4Fr5wvCsa89",pe="x-proxySettings-ProxySettings",xe="x-proxySettings-fullWidth",je="x-settings-input",me="x-proxySettings-horizontalPair",ye=({id:e,type:t,placeHolder:s,inputRef:n,handleOnChange:i})=>(0,f.jsx)("input",{type:t||"text",id:e,"data-testid":e,className:je,placeholder:s,ref:n,onChange:i}),fe=({children:e,label:t})=>(0,f.jsx)(ge.g,{label:t,className:me,children:e}),ke="x-settings-restartAppButton";function ve({onClick:e}){return(0,f.jsx)(Y.n,{className:ke,onClick:e,children:l.Ru.get("settings.restartApp")})}const Re=(e,t,s)=>{let n=`${e}:${t}`;switch(s){case 2:n+="@http";break;case 3:n+="@socks4";break;case 4:n+="@socks5"}return n},be=({addr:e,mode:t="0",pass:s,user:i,setValue:r,restartContainer:a,fullWidth:o})=>{const c=(0,n.useRef)(null),d=(0,n.useRef)(null),u=(0,n.useRef)(null),g=(0,n.useRef)(null),h=Number(t),[x,j]=(0,n.useState)(""),[m,y]=(0,n.useState)(""),[k,R]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const[t,s]=e?.split(/[:@]+/)||["",""];j(t),y(s),c.current&&(c.current.value=t),d.current&&(d.current.value=s)}),[e]),(0,n.useEffect)((()=>{g.current&&s&&(g.current.value=s.toString())}),[s]),(0,n.useEffect)((()=>{u.current&&i&&(u.current.value=i.toString())}),[i]);const b=(0,n.useCallback)((({target:e})=>{const t=Re(e.value,m,h);j(e.value),r("network.proxy.addr",t),R(!0)}),[h,m,r]),S=(0,n.useCallback)((({target:e})=>{const t=Re(x,e.value,h);y(e.value),r("network.proxy.addr",t),R(!0)}),[h,x,r]),C=(0,n.useCallback)((({target:e})=>{r("network.proxy.user",e.value),R(!0)}),[r]),M=(0,n.useCallback)((({target:e})=>{r("network.proxy.pass",e.value),R(!0)}),[r]),F=0!==h&&1!==h,Q=3!==h;return(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("desktop.settings.proxy.title"),children:[(0,f.jsx)(w,{children:l.Ru.get("desktop.settings.proxy.title")}),(0,f.jsxs)("div",{className:p()(pe,o?xe:null),children:[(0,f.jsx)(fe,{label:l.Ru.get("desktop.settings.proxy.type"),children:(0,f.jsx)(G.C,{id:"network.proxy.mode",value:t,onSelect:e=>{const t=parseInt(e,10);r("network.proxy.mode",t),R(!0)},children:ue.map((({enumKey:e,enumValue:t})=>(0,f.jsx)("option",{value:t,"data-testid":e,children:de[e]?de[e].label():""},e)))})}),F?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:he,children:[(0,f.jsx)(fe,{label:l.Ru.get("desktop.settings.proxy.host"),children:(0,f.jsx)(ye,{id:"network.proxy.host",handleOnChange:b,placeHolder:l.Ru.get("desktop.settings.proxy.host"),inputRef:c})}),(0,f.jsx)(fe,{label:l.Ru.get("desktop.settings.proxy.port"),children:(0,f.jsx)(ye,{id:"network.proxy.port",type:"number",handleOnChange:S,placeHolder:l.Ru.get("desktop.settings.proxy.port"),inputRef:d})})]}),(0,f.jsxs)("div",{className:Q?he:void 0,children:[(0,f.jsx)(fe,{label:l.Ru.get("desktop.settings.proxy.user"),children:(0,f.jsx)(ye,{id:"network.proxy.user",handleOnChange:C,placeHolder:l.Ru.get("desktop.settings.proxy.user"),inputRef:u})}),Q?(0,f.jsx)(fe,{label:l.Ru.get("desktop.settings.proxy.pass"),children:(0,f.jsx)(ye,{id:"network.proxy.pass",handleOnChange:M,placeHolder:l.Ru.get("desktop.settings.proxy.pass"),type:"password",inputRef:g})}):null]})]}):null,k&&(0,f.jsx)("div",{children:(0,f.jsx)(ve,{onClick:a})})]})]})};var we=s(9037),Se=s(84423),Ce=s(56607),Me=s(29345),Fe=s(99818);function Qe(){const e=(0,Fe.Q)(),[t,s]=(0,n.useState)(null),[i,r]=(0,n.useState)(!0),[a,l]=(0,n.useState)(null);return(0,n.useEffect)((()=>{const t=window.setInterval((()=>{!async function(){if(null===a){try{const t=await e.getStatistics();s(t)}catch(e){l(e instanceof Error?e:new Error("Error when fetching storage statistics."))}r(!1)}}()}),1500);return()=>clearInterval(t)}),[e,a]),[t,i,a]}const Ne="x-settings-button",qe="x-settings-wordBreakAll",Ae=({settings:e,setValue:t})=>{const s=(0,n.useContext)(Me._),i=(0,n.useContext)(a.b),r=!(0,Ce.n)(),[o,h]=(0,n.useState)(!1),p=(0,n.useCallback)((()=>{i.applyUpdate()}),[i]),[x,j,m]=Qe(),y=(0,we.wA)();let k="",R="",b=0;j?(k=l.Ru.get("page.loading"),R=l.Ru.get("page.loading")):m||null===x?(k=l.Ru.get("error.generic"),R=l.Ru.get("error.generic")):(b=x.currentSizeMB-x.currentLockedSizeMB,k=` ${b} MB`,R=` ${x.currentLockedSizeMB} MB`);const S=e.values["storage.location"];return(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("desktop.settings.storage"),children:[(0,f.jsx)(w,{children:l.Ru.get("desktop.settings.storage")}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.storage.downloads.heading"),children:[(0,f.jsx)(g.q,{children:(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{children:[(0,f.jsx)(c.W,{htmlFor:"desktop.settings.downloads",semanticColor:"textBase",children:l.Ru.get("desktop.settings.storage.downloads.heading")}),(0,f.jsx)(c.W,{htmlFor:"desktop.settings.downloads",children:R})]}),(0,f.jsx)(c.W,{htmlFor:"desktop.settings.downloads",children:l.Ru.get("desktop.settings.storage.downloads.text")})]})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(Y.n,{id:"desktop.settings.downloads",size:"small",onClick:()=>{y((0,Se.KB)())},disabled:r||!x||0===x.currentLockedSizeMB,className:Ne,children:l.Ru.get("desktop.settings.storage.downloads.button")})})]}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.storage.cache.heading"),children:[(0,f.jsx)(g.q,{children:(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{children:[(0,f.jsx)(c.W,{htmlFor:"desktop.settings.cache",semanticColor:"textBase",children:l.Ru.get("desktop.settings.storage.cache.heading")}),(0,f.jsx)(c.W,{htmlFor:"desktop.settings.cache",children:k})]}),(0,f.jsx)(c.W,{htmlFor:"desktop.settings.cache",children:l.Ru.get("desktop.settings.storage.cache.text")})]})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(Y.n,{id:"desktop.settings.cache",size:"small",onClick:()=>{y((0,Se.cd)())},disabled:0===b,className:Ne,children:l.Ru.get("desktop.settings.storage.cache.button")})})]}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.offlineStorageLocation"),children:[(0,f.jsx)(g.q,{children:(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.offline-storage",semanticColor:"textBase",children:l.Ru.get("desktop.settings.offlineStorageLocation")})}),(0,f.jsx)(c.W,{htmlFor:"desktop.settings.offline-storage",className:qe,children:S})]})}),(0,f.jsxs)(u.n,{children:[(0,f.jsx)(Y.n,{id:"desktop.settings.offline-storage",size:"small",onClick:async()=>{const n=await s.browseForFolder();n.path&&(t("storage.location",n.path),n.path!==e.values["storage.location"]&&h(!0))},className:Ne,children:l.Ru.get("desktop.settings.offlineStorageChangeLocation")}),o&&(0,f.jsx)(ve,{onClick:p})]})]})]})},Ee=({settings:e,setValue:t})=>{const s=(0,n.useContext)(a.b),i=(0,n.useCallback)((()=>{s.applyUpdate()}),[s]),{values:r}=e;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(ae,{settings:e,setValue:t}),(0,f.jsx)(ce,{settings:e,setValue:t}),(0,f.jsx)(Ae,{settings:e,setValue:t}),(0,f.jsx)(be,{setValue:t,restartContainer:i,mode:r["network.proxy.mode"],addr:r["network.proxy.addr"],user:r["network.proxy.user"],pass:r["network.proxy.pass"]}),(0,f.jsx)(S,{settings:e,setValue:t})]})};var _e=s(3561),We=s(40189),Le=s(43479);const Ve="obMvjPGAJ0wlp7pMtG62",Ie=({settings:{values:e}})=>{const t=(0,_e.W)(),s="1"===e["dsa-mode-enabled"],n=(0,We.t)(),[{data:i},{mutate:r}]=(0,Le.K)(n.autoPlay);return(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("desktop.settings.autoplay"),children:[(0,f.jsx)(w,{className:s?Ve:void 0,semanticColor:s?"textSubdued":void 0,children:l.Ru.get("desktop.settings.autoplay")}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.autoplayInfo"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"global.settings.autoplayInfo",className:s?Ve:void 0,children:s?l.Ru.get("web-player.settings.autoplay-dsa-enabled"):l.Ru.get("desktop.settings.autoplayInfo")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"global.settings.autoplayInfo",value:i,onSelected:e=>{t({intent:e?"enable_autoplay":"disable_autoplay",type:"click"}),r(e)},disabled:s})})]})]})};var Te=s(42094),Oe=s(3320),ze=s(26028),De=s(97027),He=s(2423),Ke=s(43722);let Ue=function(e){return e.LIBRARY_COMPACT_MODE="library-compact-mode",e.NOW_PLAYING_VIEW="now-playing-view",e.CANVAS_VIDEOS="canvas-videos",e}({});var Pe=s(49387);const Be=e=>{const{spec:t,logger:s}=(0,Pe.h)();return(0,n.useCallback)((n=>{n?s.logInteraction(t.settingsRowFactory({identifier:e}).hitSettingEnable()):s.logInteraction(t.settingsRowFactory({identifier:e}).hitSettingDisable())}),[e,s,t])},Ge=()=>{const[e,t]=(0,Ke.J)(),s=(0,He.j)(),i=Be(Ue.CANVAS_VIDEOS),r=(0,n.useCallback)((e=>{i(e),t(e)}),[t,i]);return(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("settings.canvasVideos"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"settings.canvasVideos",children:l.Ru.get("settings.canvasVideos")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"settings.canvasVideos",value:e,onSelected:r,disabled:s})})]})};var Ze=s(74250);const Je=()=>{const[e,t]=(0,Ze.N)(),s=Be(Ue.NOW_PLAYING_VIEW),i=(0,n.useCallback)((e=>{s(e),t(e)}),[t,s]);return(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("settings.npv"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"settings.npv",children:l.Ru.get("settings.npv")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"settings.npv",value:e,onSelected:i})})]})},Ye=({settings:{values:e},setValue:t})=>{const s=void 0===e.catalogue||"string"==typeof e.catalogue&&"free"===e.catalogue.toLowerCase(),n=(0,Oe.d)(),r=(0,i.NC)(M.yJ8),a=n?.client_capabilities?.can_show_system_media_controls,h=n?.client_capabilities?.can_show_track_notifications,{isActive:p,panelSend:x}=(0,ze.AI)(Te.Z.BuddyFeed);return(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("settings.display"),children:[(0,f.jsx)(w,{children:l.Ru.get("settings.display")}),(0,f.jsx)(Je,{}),r!==M.NtL.CONTROL&&(0,f.jsx)(Ge,{}),!s&&(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("settings.showMusicAnnouncements"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"settings.showMusicAnnouncements",children:l.Ru.get("settings.showMusicAnnouncements")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"settings.showMusicAnnouncements",value:!e["ui.hide_hpto"],onSelected:e=>{t("ui.hide_hpto",!e)}})})]}),h&&(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("settings.showTrackNotifications"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"settings.trackNotifications",children:l.Ru.get("settings.showTrackNotifications")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"settings.trackNotifications",value:!!e["ui.track_notifications_enabled"],onSelected:e=>{t("ui.track_notifications_enabled",e)}})})]}),a&&(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.showSystemMediaControls"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"settings.systemMediaControlsEnabled",children:l.Ru.get("desktop.settings.showSystemMediaControls")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"settings.systemMediaControlsEnabled",value:!!e["ui.system_media_controls_enabled"],onSelected:e=>{t("ui.system_media_controls_enabled",e)}})})]}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("buddy-feed.see-what-your-friends-are-playing"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"settings.showFriendActivity",children:l.Ru.get("buddy-feed.see-what-your-friends-are-playing")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"settings.showFriendActivity",value:p,onSelected:()=>{x(De.$S.BUDDY_FEED_BUTTON_CLICK)}})})]})]})};var $e=s(66849);const Xe=()=>{const e=(0,i.NC)(M.meE,{loadingValue:!1}),{playbackHandleType:t,setPlaybackHandleType:s}=(0,$e.c)();return e?(0,f.jsxs)(d.i,{filterMatchQuery:"Playback handle",children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"",children:"Custom playback handle"})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(G.C,{id:"desktop.settings.playbackHandle",value:t,onSelect:e=>{s(e)},children:Object.values($e.I).map((e=>(0,f.jsx)("option",{value:e,children:e},e)))})})]}):null};var et=s(29356),tt=s(49865),st=s(38766);const nt="m7e5wHq6US9u3BbLQXEX",it="ul4DB6lq_3qO_aCiEbcc",rt=()=>{const e=(0,we.wA)(),{locale:t,user:s,overrides:i}=(0,we.d4)(tt.Ht),r=(0,n.useRef)(null),a=(0,n.useRef)(null),l=(0,n.useCallback)((t=>{r.current&&r.current.value&&e((0,st.Rv)(t?r.current.value:""))}),[e]),o=(0,n.useCallback)((t=>{a.current&&a.current.value&&e((0,st.zf)(t?a.current.value:""))}),[e]),c=i?.country||s?.country,h=i?.locale||t;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(d.i,{filterMatchQuery:c??"",children:[(0,f.jsx)(g.q,{children:(0,f.jsx)("div",{className:nt,children:(0,f.jsx)(et.c,{id:"overrides.country",onChange:e=>{const t=e.target.checked;l(t)},defaultChecked:!!i?.country,children:(0,f.jsx)(R.E,{variant:"bodySmall",semanticColor:"textSubdued",children:"Country"})})})}),(0,f.jsx)(u.n,{children:(0,f.jsx)("input",{type:"text",id:"overrides.country.input",className:it,disabled:!i?.country,ref:r,defaultValue:c,onChange:()=>l(!0)})})]}),(0,f.jsxs)(d.i,{filterMatchQuery:i?.locale??"",children:[(0,f.jsx)(g.q,{children:(0,f.jsx)("div",{className:nt,children:(0,f.jsx)(et.c,{id:"overrides.locale",onChange:e=>{const t=e.target.checked;o(t)},defaultChecked:!!i?.locale,children:(0,f.jsx)(R.E,{variant:"bodySmall",semanticColor:"textSubdued",children:"Language"})})})}),(0,f.jsx)(u.n,{children:(0,f.jsx)("input",{type:"text",id:"overrides.locale.input",className:it,disabled:!i?.locale,ref:a,defaultValue:h,onChange:()=>o(!0)})})]})]})};var at=s(2774);const lt=({settings:{values:e},setValue:t})=>{const s=(0,at.Q)(e),i=(0,n.useContext)(a.b),[r,h]=(0,n.useState)(!1),p=(0,n.useCallback)((()=>{i.applyUpdate()}),[i]);return s?(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("settings.employee"),children:[(0,f.jsx)(w,{children:l.Ru.get("settings.employee")}),(0,f.jsx)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.language-override"),children:(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"",children:l.Ru.get("desktop.settings.language-override")})})}),(0,f.jsx)(rt,{}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.enableDeveloperMode"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"settings.developerMode",children:l.Ru.get("desktop.settings.enableDeveloperMode")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"settings.developerMode",value:!!e["app.enable-developer-mode"],onSelected:e=>{t("app.enable-developer-mode",e),h(!0)}})})]}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.showChromeToolbar"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"settings.chromiumToolbar",children:l.Ru.get("desktop.settings.showChromeToolbar")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"settings.chromiumToolbar",value:!!e["app.show-chrome-toolbar"],onSelected:e=>{t("app.show-chrome-toolbar",e),h(!0)}})})]}),r&&(0,f.jsx)("div",{children:(0,f.jsx)(ve,{onClick:p})}),(0,f.jsx)(Xe,{})]}):null},ot=({settings:{values:e},setValue:t})=>{const s="1"===e["lock-filter-explicit-content"],n="0"===e["filter-explicit-content"]||void 0===e["filter-explicit-content"],i=s?l.Ru.get("desktop.settings.explicitContentFilterSettingLocked"):l.Ru.get("desktop.settings.explicitContentFilterSetting");return(0,f.jsxs)(d.i,{filterMatchQuery:i,children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.explicitContentFilter",children:i})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.explicitContentFilter",disabled:s,value:n,onSelected:e=>{t("filter-explicit-content",e?"0":"1")}})})]})},ct=({settings:e,setValue:t})=>(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("desktop.settings.explicitContentFilter"),children:[(0,f.jsx)(w,{children:l.Ru.get("desktop.settings.explicitContentFilter")}),(0,f.jsx)(ot,{settings:e,setValue:t})]});var dt=s(90413);const ut=()=>{const e=(0,n.useContext)(a.b),t=(0,We.t)(),[{data:s},{mutate:i}]=(0,Le.K)(t.language),r=(0,n.useCallback)((()=>{e.applyUpdate()}),[e]);return void 0===s?null:(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("desktop.settings.language"),children:[(0,f.jsx)(w,{children:l.Ru.get("desktop.settings.language")}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.selectLanguage"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.selectLanguage",children:l.Ru.get("desktop.settings.selectLanguage")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(G.C,{dir:"auto",value:s,id:"desktop.settings.selectLanguage",onSelect:i,children:dt.J2.map((e=>(0,f.jsx)("option",{value:e,children:`${dt.IB[e].displayName} (${dt.IB[e].displayNameEn})`},e)))})})]}),l.Ru.getLocaleForTranslation()!==s?(0,f.jsx)(ve,{onClick:r}):null]})},gt=()=>{const[e,t]=(0,r.y)();return(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("settings.showLocalFiles"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"settings.showLocalFiles",children:l.Ru.get("settings.showLocalFiles")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"settings.showLocalFiles",value:e,onSelected:e=>{t(e)}})})]})};var ht=s(68955),pt=s(41122);const xt=e=>void 0!==e.id;function jt(e){let t;if(!xt(e))return e.path;switch(e.id){case pt.k.DOWNLOADS:t=l.Ru.get("local-files.source.downloads");break;case pt.k.ITUNES:t=l.Ru.get("local-files.source.itunes");break;case pt.k.MY_MUSIC:t=l.Ru.get("local-files.source.my_music");break;case pt.k.WINDOWS_MUSIC_LIBRARY:t=l.Ru.get("local-files.source.windows_music_library");break;default:t=String(e.id)}return t}const mt=({source:e,onAddOrRemoveSource:t})=>{const[s,i]=(0,n.useState)(!xt(e)||e.enabled),r=xt(e)?String(e.id):e.path;return(0,f.jsxs)(d.i,{filterMatchQuery:jt(e),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:`settings.local-files.${r}`,children:jt(e)})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:`settings.local-files.${r}`,value:s,onSelected:s=>{i(s),t(e,s)}})})]})},yt=()=>{const[e,t]=(0,n.useState)(),s=(0,n.useContext)(Me._),i=(0,ht.i)(),r=(0,n.useCallback)((async()=>t(await s.getSources())),[s]);(0,n.useEffect)((()=>{r()}),[r]);const a=(0,n.useCallback)((async()=>{const{path:e}=await s.browseForFolder();e&&(await s.addFolder({path:e}),r(),i.say(l.Ru.get("settings.localFilesFolderAdded",e)))}),[i,s,r]),o=(0,n.useCallback)(((e,t)=>{e.enabled=t,s.mutateDefaultSource(e)}),[s]),c=(0,n.useCallback)(((e,t)=>{t?s.addFolder(e):s.removeFolder(e)}),[s]);return(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("settings.showSongsFrom"),children:[(0,f.jsx)(w,{children:l.Ru.get("settings.showSongsFrom")}),e?.defaultSources.map((e=>(0,f.jsx)(mt,{source:e,onAddOrRemoveSource:o},String(e.id)))),e?.folders.map((e=>(0,f.jsx)(mt,{source:e,onAddOrRemoveSource:c},e.path))),(0,f.jsx)("div",{children:(0,f.jsx)(Y.n,{size:"small","aria-label":l.Ru.get("settings.addASource"),onClick:()=>{a()},children:l.Ru.get("settings.addASource")})})]})};var ft=s(88289);function kt(){const e=(0,We.t)(),[{data:t},{mutate:s}]=(0,Le.K)(e.quality.autoAdjustQuality);return void 0===t?null:(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.automatic-downgrade.title"),children:[(0,f.jsxs)(g.q,{children:[(0,f.jsx)(c.W,{htmlFor:"desktop.settings.automatic-downgrade",children:l.Ru.get("desktop.settings.automatic-downgrade.title")}),(0,f.jsx)(ft.f,{message:l.Ru.get("desktop.settings.automatic-downgrade.info")})]}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.automatic-downgrade",value:t,onSelected:s})})]})}const vt={get[le.a1.AUTOMATIC](){return l.Ru.get("desktop.settings.streamingQualityAutomatic")},get[le.a1.LOW](){return l.Ru.get("desktop.settings.streamingQualityLow")},get[le.a1.MEDIUM](){return l.Ru.get("desktop.settings.streamingQualityNormal")},get[le.a1.HIGH](){return l.Ru.get("desktop.settings.streamingQualityHigh")},get[le.a1.VERY_HIGH](){return l.Ru.get("desktop.settings.streamingQualityVeryHigh")},get[le.a1.HIFI](){return l.Ru.get("desktop.settings.streamingQualityHiFi")}};function Rt({maxQuality:e,formats:t}){const s=e===le.Qi.LOSSLESS,n=e>=le.Qi.VERY_HIGH;return(0,f.jsx)(f.Fragment,{children:t.filter((({quality:e})=>{switch(e){case le.a1.AUTOMATIC:return!s;case le.a1.LOW:case le.a1.MEDIUM:case le.a1.HIGH:return!0;case le.a1.VERY_HIGH:return n;case le.a1.HIFI:return s;default:return!1}})).map((({quality:e})=>(0,f.jsx)("option",{value:e.toString(),children:vt[e]},e)))})}var bt=s(19319);function wt(){const e=(0,We.t)();return(0,bt.I)({queryKey:["settings-formats"],queryFn:()=>e.quality.getFormats(),gcTime:36e5,staleTime:6e5}).data}var St=s(15846);function Ct(){const e=(0,We.t)(),[{data:t},{mutate:s}]=(0,Le.K)(e.quality.downloadAudioQuality),[{data:n}]=(0,Le.K)(e.quality.maxSupportedQuality),i=wt();return void 0===t||void 0===n||void 0===i?null:(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.downloadQuality.title"),children:[(0,f.jsxs)(g.q,{children:[(0,f.jsx)(c.W,{htmlFor:"desktop.settings.downloadQuality",children:l.Ru.get("desktop.settings.downloadQuality.title")}),(0,f.jsx)(ft.f,{message:l.Ru.get("desktop.settings.downloadQuality.info").replace(/(<([^>]+)>)/gi,"")})]}),(0,f.jsx)(u.n,{children:(0,f.jsx)(G.C,{id:"desktop.settings.downloadQuality",value:t.toString(),onSelect:e=>{const t=(0,St.FB)(e);t&&s(t)},children:(0,f.jsx)(Rt,{formats:i,maxQuality:n})})})]})}function Mt(){const e=(0,We.t)(),[{data:t},{mutate:s}]=(0,Le.K)(e.quality.normalizeVolume);return void 0===t?null:(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.normalize"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.normalize",children:l.Ru.get("desktop.settings.normalize")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.normalize",value:!!t,onSelected:s})})]})}var Ft=s(34612),Qt=s(77022),Nt=s(24678);const qt="teokJIHsNR2G8sc4ne4S";function At(){const e=(0,We.t)(),{enqueueSnackbar:t}=(0,Nt.d)(),s=(0,Qt.K)(Qt.X.VeryHighQualityAudio),[{data:i},{mutate:r}]=(0,Le.K)(e.quality.streamingQuality),[{data:a}]=(0,Le.K)(e.quality.maxSupportedQuality),o=wt();return(0,n.useEffect)((()=>{s&&t(l.Ru.get("web-player.feature-activation-shelf.audio_quality_toast_message"))}),[s,t]),void 0===i||void 0===a||void 0===o?null:(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.streamingQuality"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.streamingQuality",children:l.Ru.get("desktop.settings.streamingQuality")})}),(0,f.jsxs)(u.n,{children:[(0,f.jsx)(G.C,{id:"desktop.settings.streamingQuality",value:i.toString(),onSelect:e=>{const t=(0,St.FB)(e);t&&r(t)},children:(0,f.jsx)(Rt,{formats:o,maxQuality:a})}),s?(0,f.jsx)(Ft.Z,{className:qt}):null]})]})}const Et={get[le.KR.QUIET](){return l.Ru.get("desktop.settings.loudnessQuiet")},get[le.KR.NORMAL](){return l.Ru.get("desktop.settings.loudnessNormal")},get[le.KR.LOUD](){return l.Ru.get("desktop.settings.loudnessLoud")}};function _t(){const e=(0,We.t)(),[{data:t},{mutate:s}]=(0,Le.K)(e.quality.volumeLevel),[{data:n}]=(0,Le.K)(e.quality.normalizeVolume);return void 0===t||void 0===n?null:(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.loudnessEnvironment_with_limiter_details"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.loudnessEnvironment",children:l.Ru.get("desktop.settings.loudnessEnvironment_with_limiter_details")})}),(0,f.jsx)(u.n,{children:(0,f.jsxs)(G.C,{id:"desktop.settings.loudnessEnvironment",disabled:!n,value:t,onSelect:e=>{const t=(0,St.dt)(e);null!==t&&s(t)},children:[(0,f.jsx)("option",{value:le.KR.QUIET,children:Et[le.KR.QUIET]}),(0,f.jsx)("option",{value:le.KR.NORMAL,children:Et[le.KR.NORMAL]}),(0,f.jsx)("option",{value:le.KR.LOUD,children:Et[le.KR.LOUD]})]})})]})}const Wt=()=>(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("desktop.settings.musicQuality"),children:[(0,f.jsx)(w,{children:l.Ru.get("desktop.settings.musicQuality")}),(0,f.jsx)(At,{}),(0,f.jsx)(Ct,{}),(0,f.jsx)(kt,{}),(0,f.jsx)(Mt,{}),(0,f.jsx)(_t,{})]});var Lt=s(42216),Vt=s(97563),It=s(23724);const Tt=Vt.t.CONNECTION_STATE_CHANGE;var Ot=s(90970),zt=s(70251),Dt=s(15893),Ht=s(40555),Kt=s(34947);const Ut=()=>{const[e,t]=(()=>{const e=(0,Ot.jE)(),{user:t}=(0,we.d4)(tt.Ht),s=t?.uri??"",{enqueueSnackbar:i}=(0,Nt.d)(),{data:r,queryKey:a}=(0,Kt.Z)(Ht.kp,[{uri:s}]),o=(0,n.useCallback)((async({showFollows:e})=>{await(0,Ht.gN)(Dt.n.getInstance(),{uri:s,showFollows:e})}),[s]),c=(0,zt.n)({mutationFn:o,onMutate:async t=>{await e.cancelQueries({queryKey:a});const s=e.getQueryData(a);return e.setQueryData(a,t),{prevState:s,newState:t}},onError:(t,s,n)=>{e.setQueryData(a,n?.prevState),i(l.Ru.get("error.generic"))},onSettled:()=>{e.invalidateQueries({queryKey:a})}});return[r?.showFollows??!0,c.mutate]})();return(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.showFollows"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.showFollows",children:l.Ru.get("desktop.settings.showFollows")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.showFollows",value:e,onSelected:e=>t({showFollows:e})})})]})},Pt="xm2mOJwSu9_GfODYzx8M";const Bt=({settings:{values:e},setValue:t})=>{const[s,r,a]=function(){const e=(0,It.d)(),[t,s]=(0,n.useState)(null),i=(0,n.useCallback)((t=>{e.connect(t)}),[e]),r=(0,n.useCallback)((()=>{e.disconnect()}),[e]);return(0,n.useEffect)((()=>{const t=e=>{s(e.data)};return e.addListener(Tt,t),()=>{e.removeListener(Tt,t)}}),[e,s]),[t,i,r]}(),h=(0,i.NC)(M.Rww,{loadingValue:!1}),p=(0,n.useCallback)((()=>{s?.connection?a():r({window:{width:Math.max(800,window.outerWidth-100),height:Math.max(600,window.outerHeight-100)}})}),[s,r,a]);if(!(void 0!==e["publish-playlist"]&&void 0!==e["incognito-enabled"]))return null;const x=!!e["incognito-enabled"];return(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("desktop.settings.social"),children:[(0,f.jsx)(w,{children:l.Ru.get("desktop.settings.social")}),s?.show_connect_option&&(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.facebook"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.facebook",children:l.Ru.get("desktop.settings.facebook")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(Y.n,{id:"desktop.settings.facebook",size:"small",className:Pt,onClick:p,iconLeading:Lt.G,children:!0===s.connection?l.Ru.get("desktop.settings.facebook.disconnect"):l.Ru.get("desktop.settings.facebook.connect")})})]}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.newPlaylistsPublic"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.newPlaylistsPublic",children:l.Ru.get("desktop.settings.newPlaylistsPublic")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.newPlaylistsPublic",value:"1"===e["publish-playlist"],onSelected:e=>{t("publish-playlist",e?"1":"0")}})})]}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.privateSession"),children:[(0,f.jsxs)(g.q,{children:[(0,f.jsx)(c.W,{htmlFor:"desktop.settings.privateSession",children:l.Ru.get("desktop.settings.privateSession")}),(0,f.jsx)(ft.f,{message:l.Ru.get("desktop.settings.privateSession.tooltip")})]}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.privateSession",value:!!e["incognito-enabled"],onSelected:e=>{t("incognito-enabled",e)}})})]}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.publishActivity"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.publishActivity",children:l.Ru.get("desktop.settings.publishActivity")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.publishActivity",disabled:x,value:"0"!==e["publish-activity"],onSelected:e=>{t("publish-activity",e?"1":"0")}})})]}),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("desktop.settings.publishTopArtists"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"desktop.settings.publishTopArtists",children:l.Ru.get("desktop.settings.publishTopArtists")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"desktop.settings.publishTopArtists",disabled:x,value:"1"===e["public-toplist"],onSelected:e=>{t("public-toplist",e?"1":"0")}})})]}),h&&(0,f.jsx)(Ut,{})]})};var Gt=s(31438),Zt=s(57958),Jt=(s(88480),s(80602)),Yt=s(15870),$t=s(92980);const Xt=new(s(57108).l)("changeAttributes","mutation","ac50e9d82b3b8303c73512f297140e774a69eb0d6250769b5669e69b4be28886",null);s(8010);const es=["personalizedRecommendations"],ts=()=>{const{getGraphQLLoader:e}=(0,$t.mv)(),t=e(),s=(0,Ot.jE)(),i=((0,Zt.g)(),(0,we.wA)()),r=!(0,Ce.n)(),a="1"===(0,Jt.$)("dsa-mode-enabled"),l="1"===(0,Jt.$)("dsa-mode-available"),o=(0,n.useCallback)((async e=>{if(r)throw new Error("User has to be online");await async function(e,t){const s=await e(Xt,{input:{dsaModeEnabled:t,birthdate:null,filterAgeRestrictedContent:null,filterExplicitContent:null,lockFilterExplicitContent:null,optInTrialPremiumOnlyMarket:null}}),{errors:n,data:i}=s||{};if(!i?.changeUserAccountAttributes)throw n&&n.length>0?new Error(`GraphQL error: ${n[0].message}`):new Error("Unknown GraphQL error!");if("ChangeUserAccountAttributesResult"!==i.changeUserAccountAttributes.__typename||"ChangeUserAccountAttributesResult"===i.changeUserAccountAttributes.__typename&&!i.changeUserAccountAttributes.success)throw new Error("Couldn't successfully set new value")}(t,e)}),[r,t]),c=(0,n.useRef)(a);c.current=a;const{data:d}=(0,bt.I)({queryKey:es,queryFn:()=>c.current});return[l??!1,d??!1,(0,zt.n)({mutationFn:o,onMutate:async e=>{await s.cancelQueries({queryKey:es});const t=s.getQueryData(es);return s.setQueryData(es,e),{prevState:t,newState:e}},onError:(e,t,n)=>{s.setQueryData(es,n?.prevState),i(Yt.bL.actions.open())},onSuccess:()=>{0}}).mutate]};var ss=s(83648);const ns="xpVsqMQfmc20cBLG04zw",is=({dsaModeEnabled:e,setDsaModeEnabled:t})=>{const s=(0,we.wA)(),i=(0,ss.zy)(),r=new URLSearchParams(i.search).get("highlight"),a=(0,n.useRef)(null);return(0,n.useEffect)((()=>{r?.includes("dsa")&&a.current&&(a.current.focus(),document.documentElement.classList.remove("no-focus-outline"))}),[r]),(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("web-player.settings.personalized-recommendations"),children:[(0,f.jsxs)(g.q,{className:ns,children:[(0,f.jsx)(c.W,{htmlFor:"settings.dsaMode",children:l.Ru.get("web-player.settings.personalized-recommendations")}),(0,f.jsx)(c.W,{htmlFor:"settings.dsaMode",variant:"marginal",children:l.Ru.get("web-player.settings.personalized-recommendations-body-text")})]}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"settings.dsaMode",value:!e,onSelected:e=>{e?t(!e):s(Yt.lf.actions.open({onConfirm:()=>t(!e)}))},inputRef:a})})]})},rs=({sectionAbove:e})=>{const[t,s,n]=ts();return t||e?(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("web-player.settings.content-preferences"),children:[(0,f.jsx)(w,{children:l.Ru.get("web-player.settings.content-preferences")}),e,t&&(0,f.jsx)(is,{dsaModeEnabled:s,setDsaModeEnabled:n})]}):null};var as=s(55550);const ls=()=>{const{libraryRowMode:e,setLibraryRowMode:t}=(0,as.q)(),s=Be(Ue.LIBRARY_COMPACT_MODE),i=(0,n.useCallback)((e=>{s(e),t(e?as.A.COMPACT:as.A.DEFAULT)}),[s,t]);return(0,f.jsxs)(d.i,{filterMatchQuery:l.Ru.get("settings.library.compactMode"),children:[(0,f.jsx)(g.q,{children:(0,f.jsx)(c.W,{htmlFor:"settings.library.compact-mode",children:l.Ru.get("settings.library.compactMode")})}),(0,f.jsx)(u.n,{children:(0,f.jsx)(o.l,{id:"settings.library.compact-mode",value:e===as.A.COMPACT,onSelected:i})})]})},os=({children:e})=>(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(v,{filterMatchQuery:l.Ru.get("settings.library"),children:[(0,f.jsx)(w,{children:l.Ru.get("settings.library")}),e]})}),cs="x-settings-container",ds=({children:e,outerRef:t})=>(0,f.jsx)(m.s,{uri:"spotify:internal:settings",children:(0,f.jsx)("div",{ref:t,className:cs,"data-testid":"settings-page",children:e})});var us=s(90313),gs=s(91377);const hs="x-settings-headerContainer",ps="x-settings-header";function xs({containerRef:e}){return(0,f.jsxs)("div",{className:hs,children:[(0,f.jsx)(R.E,{as:"h1",variant:"titleMedium",className:ps,semanticColor:"textBase",paddingBottom:us.CD,children:l.Ru.get("desktop.settings.settings")}),(0,f.jsx)("div",{children:(0,f.jsx)(gs.S,{placeholder:"",alwaysExpanded:!1,clearOnEscapeInElementRef:e,debounceFilterChangeTimeout:0})})]})}const js=()=>{const{settings:e,setValue:t}=(0,Gt.t0)(),s=(0,n.useRef)(null),[a]=(0,r.y)(),l=(0,i.NC)(M.YSK),o=(0,i.NC)(M.AEN);return(0,f.jsxs)(ds,{outerRef:s,children:[(0,f.jsx)(xs,{containerRef:s}),(0,f.jsx)(ut,{}),l?(0,f.jsx)(rs,{sectionAbove:(0,f.jsx)(ot,{settings:e,setValue:t})}):(0,f.jsx)(ct,{settings:e,setValue:t}),(0,f.jsx)(Ie,{settings:e,setValue:t}),(0,f.jsx)(Wt,{}),(0,f.jsxs)(os,{children:[!o&&(0,f.jsx)(ls,{}),(0,f.jsx)(gt,{})]}),a?(0,f.jsx)(yt,{}):null,(0,f.jsx)(Ye,{settings:e,setValue:t}),(0,f.jsx)(Bt,{settings:e,setValue:t}),(0,f.jsx)(Ee,{settings:e,setValue:t}),(0,f.jsx)(lt,{settings:e,setValue:t})]})},ms=js},40189:(e,t,s)=>{s.d(t,{t:()=>i});var n=s(37100);function i(){return(0,n.j4)()}},43479:(e,t,s)=>{s.d(t,{K:()=>d});var n=s(79474),i=s(90970),r=s(19319),a=s(70251),l=s(55334);class o extends l.e{}var c=s(8889);function d(e){const t=(0,n.useMemo)((()=>["useSettingsValue",e.key]),[e.key]),s=(0,i.jE)(),l=(0,r.I)({queryKey:t,queryFn:async()=>await e.getValue(),gcTime:36e5,staleTime:6e5,retry:(e,t)=>t instanceof o&&e<3}),d=(0,a.n)({mutationFn:async t=>{await e.setValue(t)},onMutate:async e=>{await s.cancelQueries({queryKey:t});const n=s.getQueryData(t);return s.setQueryData(t,e),{prevState:n,newState:e}},retry:(e,t)=>t instanceof o&&e<3,onError:(n,i,r)=>{n instanceof c.N||console.error(`Error setting ${e.key}`,n),s.setQueryData(t,r?.prevState)}});return(0,n.useEffect)((()=>e.subValue((e=>{s.setQueryData(t,e)}))),[s,t,e]),[l,d]}},3320:(e,t,s)=>{s.d(t,{d:()=>r});var n=s(79474),i=s(63204);const r=()=>(0,n.useContext)(i.D)}}]);
//# sourceMappingURL=xpui-routes-desktop-settings.js.map